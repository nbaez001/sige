package com.sige.gui;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.vaadin.dialogs.ConfirmDialog;

import com.sige.entidad.Lugar;
import com.sige.entidad.Persona;
import com.sige.entidad.PersonaDocumento;
import com.sige.entidad.TipoDocumentoPersona;
import com.sige.entidad.TipoPersonaJuridica;
import com.sige.entidad.Via;
import com.sige.servicio.LugarServicio;
import com.sige.servicio.PersonaDocumentoServicio;
import com.sige.servicio.PersonaServicio;
import com.sige.servicio.TipoDocumentoPersonaServicio;
import com.sige.servicio.TipoPersonaJuridicaServicio;
import com.sige.servicio.UtilService;
import com.sige.servicio.ViaServicio;
import com.sige.util.Boton;
import com.sige.util.Constantes;
import com.sige.util.Injector;
import com.sige.util.Notificacion;
import com.sige.util.Permiso;
import com.sige.util.SigeUtil;
import com.sige.util.TextField;
import com.vaadin.annotations.AutoGenerated;
import com.vaadin.data.Item;
import com.vaadin.data.Property;
import com.vaadin.data.Property.ValueChangeEvent;
import com.vaadin.data.Property.ValueChangeListener;
import com.vaadin.data.util.IndexedContainer;
import com.vaadin.server.ThemeResource;
import com.vaadin.ui.AbsoluteLayout;
import com.vaadin.ui.Button;
import com.vaadin.ui.Button.ClickEvent;
import com.vaadin.ui.Button.ClickListener;
import com.vaadin.ui.ComboBox;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.Label;
import com.vaadin.ui.Panel;
import com.vaadin.ui.Table;
import com.vaadin.ui.UI;
import com.vaadin.ui.Window;
import com.vaadin.ui.themes.Reindeer;

public class PersonaMantenimiento extends CustomComponent implements
		ClickListener {

	/*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

	@AutoGenerated
	private AbsoluteLayout mainLayout;
	@AutoGenerated
	private Panel panel_1;
	@AutoGenerated
	private AbsoluteLayout absoluteLayout_2;
	@AutoGenerated
	private TextField txtNumero;
	@AutoGenerated
	private Boton btnQuitar;
	@AutoGenerated
	private Boton btnAgregr;
	@AutoGenerated
	private Label lblNumero;
	@AutoGenerated
	private Table tblDatosDocumento;
	@AutoGenerated
	private ComboBox cbxTipoDocumento;
	@AutoGenerated
	private Label lblTipoDocumento;
	@AutoGenerated
	private Boton btnAgregarVia;
	@AutoGenerated
	private Boton btnAgregarLugar;
	@AutoGenerated
	private Button btnImprimir;
	@AutoGenerated
	private Button btnBuscar;
	@AutoGenerated
	private Button btnCancelar;
	@AutoGenerated
	private Button btnEliminar;
	@AutoGenerated
	private Button btnGuardar;
	@AutoGenerated
	private Button btnNuevo;
	@AutoGenerated
	private Panel pnlDireccion;
	@AutoGenerated
	private AbsoluteLayout DireccionLayout;
	@AutoGenerated
	private TextField txtPisoDir;
	@AutoGenerated
	private TextField txtManzanaDir;
	@AutoGenerated
	private TextField txtLoteDir;
	@AutoGenerated
	private Label lblLoteDir;
	@AutoGenerated
	private Label lblManzanaDir;
	@AutoGenerated
	private Label lblPisoDir;
	@AutoGenerated
	private TextField txtDepartamentoDir;
	@AutoGenerated
	private Label lblDepartamentoDir;
	@AutoGenerated
	private TextField txtNumeroDir;
	@AutoGenerated
	private Label lblNumeroDir;
	@AutoGenerated
	private Boton btnBuscarVia;
	@AutoGenerated
	private TextField txtVia;
	@AutoGenerated
	private Boton btnBuscarLugar;
	@AutoGenerated
	private TextField txtLugar;
	@AutoGenerated
	private TextField txtNombreCompleto;
	@AutoGenerated
	private Label lblNombreCompleto;
	@AutoGenerated
	private TextField txtApeMaterno;
	@AutoGenerated
	private TextField txtApePaterno;
	@AutoGenerated
	private TextField txtNombres;
	@AutoGenerated
	private ComboBox cbxTipoPersonaJuridica;
	@AutoGenerated
	private ComboBox cbxTipoPersona;
	@AutoGenerated
	private Label lblVia;
	@AutoGenerated
	private Label lblTipoPersonaJur;
	@AutoGenerated
	private Label lblLugar;
	@AutoGenerated
	private Label lblTipoPersona;
	@AutoGenerated
	private Label lblApeMaterno;
	@AutoGenerated
	private Label lblApePaterno;
	@AutoGenerated
	private Label lblNombre;
	private static final long serialVersionUID = 1L;
	/**
	 * The constructor should first build the main layout, set the composition
	 * root and then do any custom initialization.
	 * 
	 * The constructor will not be automatically regenerated by the visual
	 * editor.
	 */
	private UtilService utilService;
	private Map<String, Integer> columnLenghts;
	private Persona persona;
	private CustomComponent quienLlama;
	private Lugar lugarSeleccionado;
	private Via viaSeleccionada;
	private TipoPersonaJuridica tipoPersonaJuridicaSeleccionada;
	private PersonaServicio personaServicio;
	private boolean flagEsNuevo = false;
	private LugarServicio lugarServicio;
	private ViaServicio viaServicio;
	private TipoPersonaJuridicaServicio tipoPersonaJuridicaServicio;
	private Permiso permiso;
	private Window windowContiene;
	private TipoDocumentoPersonaServicio tipoDocumentoPersonaServicio;
	private Long id;
	private List<PersonaDocumento> personaDocumentos;
	private Boolean documentoSeleccionado;
	private Long codigoTipoDocumentoSeleccionado;
	private PersonaDocumentoServicio personaDocumentoServicio;
	private Map<String, Integer> personaDocumentoColumnLenghts;
	private boolean confirmacion = false;

	public PersonaMantenimiento(Window windowContiene,
			CustomComponent quienLlama, Permiso permiso) {
		utilService = Injector.obtenerServicio(UtilService.class);
		personaServicio = Injector.obtenerServicio(PersonaServicio.class);
		lugarServicio = Injector.obtenerServicio(LugarServicio.class);
		viaServicio = Injector.obtenerServicio(ViaServicio.class);
		this.tipoDocumentoPersonaServicio = Injector
				.obtenerServicio(TipoDocumentoPersonaServicio.class);
		this.tipoPersonaJuridicaServicio = Injector
				.obtenerServicio(TipoPersonaJuridicaServicio.class);
		this.personaDocumentoServicio = Injector
				.obtenerServicio(PersonaDocumentoServicio.class);
		this.quienLlama = quienLlama;
		this.permiso = permiso;
		this.windowContiene = windowContiene;
		buildMainLayout();
		setCompositionRoot(mainLayout);
		postBuid();
		resetearFormulario();
	}

	private void postBuid() {
		columnLenghts = utilService.getLengthColumns("persona");
		personaDocumentoColumnLenghts = utilService
				.getLengthColumns("personasdocum");
		this.txtNumero.setMaxLength(personaDocumentoColumnLenghts
				.get("numdocum"));
		this.txtNombreCompleto
				.setMaxLength(columnLenghts.get("nombrecompleto"));
		this.txtNombres.setMaxLength(columnLenghts.get("nombres"));
		this.txtApePaterno.setMaxLength(columnLenghts.get("apellidopaterno"));
		this.txtApeMaterno.setMaxLength(columnLenghts.get("apellidomaterno"));
		this.txtDepartamentoDir
				.setMaxLength(columnLenghts.get("direcciondpto"));
		this.txtNumeroDir.setMaxLength(columnLenghts.get("direccionnumero"));
		this.txtPisoDir.setMaxLength(columnLenghts.get("direccionpiso"));
		this.txtManzanaDir.setMaxLength(columnLenghts.get("direccionmzna"));
		this.txtLoteDir.setMaxLength(columnLenghts.get("direccionlote"));
		txtNombres.setTabIndex(3);
		txtApePaterno.setTabIndex(4);
		txtApeMaterno.setTabIndex(5);
		btnBuscarLugar.setTabIndex(6);
		btnAgregarLugar.setTabIndex(7);
		btnBuscarVia.setTabIndex(8);
		btnAgregarVia.setTabIndex(9);
		txtNumeroDir.setTabIndex(10);
		txtDepartamentoDir.setTabIndex(11);
		txtPisoDir.setTabIndex(12);
		txtManzanaDir.setTabIndex(13);
		txtLoteDir.setTabIndex(14);
		txtNumero.setTabIndex(16);
		btnAgregr.setTabIndex(17);
		btnQuitar.setTabIndex(18);
		btnNuevo.setTabIndex(19);
		btnGuardar.setTabIndex(20);
		btnEliminar.setTabIndex(21);
		btnCancelar.setTabIndex(22);
		btnBuscar.setTabIndex(23);
		btnImprimir.setTabIndex(24);
		this.btnNuevo.addClickListener((ClickListener) this);
		this.btnGuardar.addClickListener((ClickListener) this);
		this.btnCancelar.addClickListener((ClickListener) this);
		this.btnEliminar.addClickListener((ClickListener) this);
		this.btnBuscar.addClickListener((ClickListener) this);
		this.btnAgregr.addClickListener((ClickListener) this);
		this.btnImprimir.addClickListener((ClickListener) this);
		this.btnQuitar.addClickListener((ClickListener) this);
		this.btnBuscarVia.addClickListener((ClickListener) this);
		this.btnBuscarLugar.addClickListener((ClickListener) this);
		this.btnBuscarLugar.setStyleName(Reindeer.BUTTON_LINK);
		this.btnBuscarVia.setStyleName(Reindeer.BUTTON_LINK);
		this.btnAgregr.setStyleName(Reindeer.BUTTON_LINK);
		this.btnQuitar.setStyleName(Reindeer.BUTTON_LINK);
		this.btnAgregarLugar.addClickListener((ClickListener) this);
		this.btnAgregarVia.addClickListener((ClickListener) this);
		this.btnAgregarVia.setStyleName(Reindeer.BUTTON_LINK);
		this.btnAgregarLugar.setStyleName(Reindeer.BUTTON_LINK);
		this.txtVia.setEnabled(false);
		this.txtLugar.setEnabled(false);

		personaDocumentos = new ArrayList<PersonaDocumento>();

		documentoSeleccionado = Boolean.FALSE;
		cbxTipoPersonaJuridica.setImmediate(true);
		cbxTipoPersona.setImmediate(true);
		cbxTipoPersona.addItem('1');
		cbxTipoPersona.setItemCaption('1', "PERSONA NATURAL");
		cbxTipoPersona.addItem('2');
		cbxTipoPersona.setItemCaption('2', "PERSONA JURIDICA");
		cbxTipoPersona.setValue('1');
		cbxTipoPersona.setNullSelectionAllowed(false);
		cbxTipoPersonaJuridica.setEnabled(false);
		txtNombreCompleto.setEnabled(false);
		this.btnCancelar.setId("cancelar");
		this.btnEliminar.setId("eliminar");
		this.btnGuardar.setId("guardar");
		this.btnNuevo.setId("nuevo");
		this.btnImprimir.setId("imprimir");
		this.btnBuscar.setId("consultar");
		SigeUtil.validarBotones(permiso, btnNuevo, btnEliminar, btnCancelar,
				btnGuardar, btnImprimir, btnBuscar);
		if (!permiso.getConsultar()) {
			this.btnBuscar.setVisible(permiso.getModificar());
		}

		cbxTipoPersona.addValueChangeListener(new ValueChangeListener() {
			private static final long serialVersionUID = 1L;

			@Override
			public void valueChange(ValueChangeEvent event) {
				if ((Character) cbxTipoPersona.getValue() == '2') {
					cbxTipoPersonaJuridica.setEnabled(true);
					txtApeMaterno.setEnabled(false);
					txtApePaterno.setEnabled(false);
					txtNombres.setEnabled(false);
					txtNombreCompleto.setEnabled(true);
					txtApeMaterno.setValue("");
					txtApePaterno.setValue("");
					txtNombres.setValue("");
				} else {
					cbxTipoPersonaJuridica.setEnabled(false);
					txtApeMaterno.setEnabled(true);
					txtApePaterno.setEnabled(true);
					txtNombres.setEnabled(true);
					txtNombreCompleto.setEnabled(false);
					txtNombreCompleto.setValue("");
				}
				cbxTipoPersonaJuridica.setValue(null);
			}
		});

		cbxTipoDocumento.setImmediate(true);

		cbxTipoDocumento.addValueChangeListener(new ValueChangeListener() {
			private static final long serialVersionUID = 1L;

			@Override
			public void valueChange(ValueChangeEvent event) {
				txtNumero.setValue("");
				if (cbxTipoDocumento
						.getItemCaption(cbxTipoDocumento.getValue()).trim()
						.equalsIgnoreCase("DNI")) {
					txtNumero.setMaxLength(8);
				} else if (cbxTipoDocumento
						.getItemCaption(cbxTipoDocumento.getValue()).trim()
						.equalsIgnoreCase("RUC")) {
					txtNumero.setMaxLength(11);
				} else {
					txtNumero.setMaxLength(personaDocumentoColumnLenghts
							.get("numdocum"));
				}
			}
		});

		cargarComboPersonaJuridica();
		llenarComboTipoDocumento();
		IndexedContainer contenido = new IndexedContainer();
		contenido.addContainerProperty("id", Long.class, null);
		contenido.addContainerProperty("codigo", Long.class, null);
		contenido.addContainerProperty("documento", String.class, null);
		contenido.addContainerProperty("numero", String.class, null);
		tblDatosDocumento.setContainerDataSource(contenido);
		tblDatosDocumento.setVisibleColumns(new Object[] { "codigo",
				"documento", "numero" });
		tblDatosDocumento.setColumnHeader("codigo", "Cod.Doc.");
		tblDatosDocumento.setColumnHeader("documento", "Documento");
		tblDatosDocumento.setColumnHeader("numero", "Numero");
		tblDatosDocumento.setColumnWidth("codigo", 25);
		tblDatosDocumento.setColumnWidth("documento", 180);
		tblDatosDocumento.setColumnWidth("numero", 100);
		tblDatosDocumento.setSelectable(true);
		tblDatosDocumento.setImmediate(true);
		this.tblDatosDocumento
				.addValueChangeListener(new Property.ValueChangeListener() {

					private static final long serialVersionUID = 1L;

					public void valueChange(ValueChangeEvent event) {
						// TODO Auto-generated method stub
						Item item = tblDatosDocumento.getItem(tblDatosDocumento
								.getValue());
						if (item != null) {
							if (item.getItemProperty("id").getValue() != null) {
								id = new Long(item.getItemProperty("id")
										.getValue().toString());
							} else {
								id = null;
							}

							documentoSeleccionado = Boolean.TRUE;
							cbxTipoDocumento.setValue(item.getItemProperty(
									"codigo").getValue());
							codigoTipoDocumentoSeleccionado = (Long) item
									.getItemProperty("codigo").getValue();
							txtNumero.setValue(item.getItemProperty("numero")
									.getValue().toString());
						}
						tblDatosDocumento.unselect(tblDatosDocumento.getValue());
					}
				});

	}

	public void obtenerMotivo(String motivo, Boolean confirmacion,
			Integer tipoOperacion) {
		if (confirmacion) {
			persona.setMotivoModificacion(motivo);
			this.confirmacion = true;
			if (tipoOperacion.equals(Constantes.TIPO_OPERACION.MODIFICACION)) {
				btnGuardar.click();
			} else {
				btnEliminar.click();
			}
			this.confirmacion = false;
		}
	}

	private void llenarComboTipoDocumento() {
		List<TipoDocumentoPersona> listaTipoDocumentosPersona = tipoDocumentoPersonaServicio
				.obtenerTodos();
		for (TipoDocumentoPersona tp : listaTipoDocumentosPersona) {
			cbxTipoDocumento.addItem(tp.getId());
			cbxTipoDocumento.setItemCaption(tp.getId(), tp.getAbreviatura()
					.trim());
		}
		if (listaTipoDocumentosPersona.size() > 0) {
			cbxTipoDocumento
					.setValue(listaTipoDocumentosPersona.get(0).getId());
		}
		cbxTipoDocumento.setNullSelectionAllowed(false);
	}

	private void cargarComboPersonaJuridica() {
		List<TipoPersonaJuridica> lsTipoPersonaJuridica = tipoPersonaJuridicaServicio
				.obtenerTodos();
		for (TipoPersonaJuridica tipoPersonaJuridica : lsTipoPersonaJuridica) {
			if (tipoPersonaJuridica.getCodigoPersona() == '2') {
				cbxTipoPersonaJuridica.addItem(tipoPersonaJuridica.getId());
				cbxTipoPersonaJuridica.setItemCaption(
						tipoPersonaJuridica.getId(),
						tipoPersonaJuridica.getNombre());
			}
		}
		cbxTipoPersonaJuridica.setNullSelectionAllowed(false);
	}

	private void desactivarCampos(boolean estado) {
		txtApeMaterno.setEnabled(estado);
		txtApePaterno.setEnabled(estado);
		pnlDireccion.setEnabled(estado);
		txtNombreCompleto.setEnabled(estado);
		txtNombres.setEnabled(estado);
		cbxTipoPersona.setEnabled(estado);
		this.txtNumero.setEnabled(estado);
		this.cbxTipoDocumento.setEnabled(estado);
		tblDatosDocumento.setEnabled(estado);
	}

	private void resetearFormulario() {
		this.flagEsNuevo = false;
		this.btnCancelar.setEnabled(false);
		this.btnNuevo.setEnabled(true);
		this.btnGuardar.setEnabled(false);
		this.btnBuscar.setEnabled(true);
		this.btnBuscarLugar.setEnabled(false);
		this.btnBuscarVia.setEnabled(false);
		this.btnAgregarLugar.setEnabled(false);
		this.btnAgregarVia.setEnabled(false);
		this.btnQuitar.setEnabled(false);
		this.btnAgregr.setEnabled(false);

		this.btnImprimir.setEnabled(false);
		desactivarCampos(false);
		resetearComun();

	}

	private void resetearComun() {
		personaDocumentos.removeAll(personaDocumentos);
		this.btnEliminar.setEnabled(false);
		this.btnImprimir.setEnabled(false);
		this.txtApeMaterno.setValue("");
		this.txtNombres.setValue("");
		this.txtApePaterno.setValue("");
		this.txtDepartamentoDir.setValue("");
		this.txtLoteDir.setValue("");
		this.txtLugar.setValue("");
		this.txtManzanaDir.setValue("");
		this.txtNombreCompleto.setValue("");
		this.txtNumeroDir.setValue("");
		this.txtPisoDir.setValue("");
		this.txtVia.setValue("");
		cbxTipoPersona.setValue('1');
		this.txtNumero.setValue("");
		txtNombreCompleto.setEnabled(false);
		cbxTipoPersonaJuridica.setEnabled(false);
		resetearTabla();
	}

	private void resetearTabla() {
		((IndexedContainer) tblDatosDocumento.getContainerDataSource())
				.removeAllItems();
	}

	private void NuevoRegistro() {
		persona = new Persona();
		this.flagEsNuevo = true;
		this.btnGuardar.setCaption("Guardar");
		this.btnGuardar.setVisible(permiso.getNuevo());
		this.btnGuardar.setEnabled(true);
		this.btnCancelar.setVisible(permiso.getNuevo());
		this.btnCancelar.setEnabled(true);
		this.btnNuevo.setEnabled(false);
		this.btnBuscar.setEnabled(false);
		this.btnBuscarLugar.setEnabled(true);
		this.btnBuscarVia.setEnabled(true);
		this.btnAgregarLugar.setEnabled(true);
		this.btnAgregarVia.setEnabled(true);

		this.txtNumero.setEnabled(true);
		this.cbxTipoPersona.setEnabled(true);
		tblDatosDocumento.setEnabled(true);
		this.btnQuitar.setEnabled(true);
		this.btnAgregr.setEnabled(true);
		desactivarCampos(permiso.getNuevo());
		resetearComun();
	}

	public void getLugarSeleccionado(Long idLugar) {
		lugarSeleccionado = lugarServicio.obtener(idLugar);
		txtLugar.setValue(lugarSeleccionado.getNombre());
	}

	public void getViaSeleccionada(Long idVia) {
		viaSeleccionada = viaServicio.obtener(idVia);
		txtVia.setValue(viaSeleccionada.getNombre());
	}

	public void obtenerTipoPersonaJuridica(Long idTipoPersonaJuridica) {
		if (idTipoPersonaJuridica == null) {
			idTipoPersonaJuridica = tipoPersonaJuridicaServicio
					.obtenerIdPersonaJuridica((Character) cbxTipoPersona
							.getValue());
		}
		tipoPersonaJuridicaSeleccionada = tipoPersonaJuridicaServicio
				.obtener(idTipoPersonaJuridica);
	}

	public void getPersonaSeleccionada(Long idPersona) {

		personaDocumentos.removeAll(personaDocumentos);

		persona = personaServicio.obtener(idPersona);
		tipoPersonaJuridicaSeleccionada = persona.getTipoPersonaJuridica();

		cbxTipoPersona.setValue(tipoPersonaJuridicaSeleccionada
				.getCodigoPersona());
		desactivarCampos(permiso.getModificar());
		if (tipoPersonaJuridicaSeleccionada.getCodigoPersona() == '2') {
			cbxTipoPersonaJuridica.setEnabled(true);
			cbxTipoPersonaJuridica.setValue(tipoPersonaJuridicaSeleccionada
					.getId());
			txtApeMaterno.setEnabled(false);
			txtApePaterno.setEnabled(false);
			txtNombres.setEnabled(false);
		} else {
			cbxTipoPersonaJuridica.setEnabled(false);
			cbxTipoPersonaJuridica.setValue(null);
			txtNombreCompleto.setEnabled(false);
		}
		txtApeMaterno.setValue(persona.getApellidoMaterno().trim());
		txtApePaterno.setValue(persona.getApellidoPaterno().trim());
		txtDepartamentoDir.setValue(persona.getDireccionDepartamento().trim());
		txtLoteDir.setValue(persona.getDireccionLote().trim());

		lugarSeleccionado = persona.getLugar();
		txtLugar.setValue(lugarSeleccionado.getNombre().trim());

		viaSeleccionada = persona.getVia();

		txtVia.setValue(viaSeleccionada.getNombre());
		txtManzanaDir.setValue(persona.getDireccionManzana().trim());
		txtNombreCompleto.setValue(persona.getNombreCompleto().trim());
		txtNombres.setValue(persona.getNombres().trim());
		txtNumeroDir.setValue(persona.getDireccionNumero().trim());
		txtPisoDir.setValue(persona.getDireccionPiso().trim());

		btnGuardar.setCaption("Actualizar");
		flagEsNuevo = false;
		btnCancelar.setVisible(permiso.getModificar());
		btnCancelar.setEnabled(true);
		btnEliminar.setEnabled(true);
		btnGuardar.setVisible(permiso.getModificar());
		btnGuardar.setEnabled(true);
		btnImprimir.setVisible(permiso.getModificar());
		btnImprimir.setEnabled(true);
		btnBuscarLugar.setEnabled(true);
		btnBuscarVia.setEnabled(true);
		txtNumero.setEnabled(true);
		cbxTipoDocumento.setEnabled(true);
		tblDatosDocumento.setEnabled(true);
		this.btnQuitar.setEnabled(true);
		this.btnAgregr.setEnabled(true);
		this.btnImprimir.setVisible(permiso.getImprimir());
		this.btnImprimir.setEnabled(true);
		personaDocumentos = personaDocumentoServicio
				.obtenerPorCodigoPersona(persona.getCodigoPersona());
		actualizarTabla();
	}

	@Override
	public void buttonClick(ClickEvent event) {
		if (event.getSource() == this.btnNuevo) {
			NuevoRegistro();
			this.txtNombres.focus();
		} else {
			if (event.getSource() == this.btnGuardar) {
				boolean valido = false;
				if ((Character) cbxTipoPersona.getValue() == '1') {
					valido = SigeUtil.validarCamposTexto(txtApeMaterno,
							txtApePaterno, txtLugar, txtVia);
				} else if ((Character) cbxTipoPersona.getValue() == '2') {
					valido = SigeUtil.validarCamposTexto(txtNombreCompleto,
							txtLugar, txtVia)
							&& cbxTipoPersonaJuridica.getValue() != null;
				}
				if (!(tblDatosDocumento.size() > 0)) {
					Notificacion.show(new Notificacion(
							"Debe agregar el documento",
							Constantes.MENSAJE.TYPE_ERROR));
					return;
				}
				if (valido) {
					persona.setApellidoMaterno(txtApeMaterno.getValue()
							.toString());
					persona.setApellidoPaterno(txtApePaterno.getValue()
							.toString());
					persona.setDireccionDepartamento(txtDepartamentoDir
							.getValue().toString());
					persona.setDireccionLote(txtLoteDir.getValue().toString());
					persona.setDireccionManzana(txtManzanaDir.getValue()
							.toString());
					if (txtNumeroDir.getValue().toString().length() > 0) {
						persona.setDireccionNumero(txtNumeroDir.getValue()
								.toString());
					} else {
						persona.setDireccionNumero("");
					}
					persona.setDireccionPiso(txtPisoDir.getValue().toString());
					persona.setLugar(lugarSeleccionado);
					String nombreCompleto = txtNombreCompleto.getValue()
							.toString();
					if ((Character) cbxTipoPersona.getValue() == '1') {
						nombreCompleto = txtNombres.getValue().toString() + " "
								+ txtApePaterno.getValue().toString() + " "
								+ txtApeMaterno.getValue().toString();
					}
					persona.setNombreCompleto(nombreCompleto);
					persona.setNombres(txtNombres.getValue().toString());
					persona.setVia(viaSeleccionada);

					if (flagEsNuevo)
						obtenerTipoPersonaJuridica((Long) cbxTipoPersonaJuridica
								.getValue());

					persona.setTipoPersonaJuridica(tipoPersonaJuridicaSeleccionada);
					persona.setCodigoTipoPersona(tipoPersonaJuridicaSeleccionada
							.getCodigoPersona());
					persona.setPersonasDocumentos(personaDocumentos);
					if (this.flagEsNuevo) {
						personaServicio.crear(persona, personaDocumentos);
						Notificacion.show(new Notificacion(
								"Se guardo correctamente a la persona",
								Constantes.MENSAJE.TYPE_SUCCES));
						respuesta(persona);
					} else {
						persona.setNombreCompleto(nombreCompleto);
						if (!confirmacion) {
							Window ventana = SigeUtil.generarBuscador(
									new Window(), "INGRESAR MOTIVO", "360",
									"260");
							ventana.setContent(new PanelMotivoObservacion(
									ventana, this,
									Constantes.TIPO_OPERACION.MODIFICACION,
									(columnLenghts.get("motivomodifica"))));
							UI.getCurrent().addWindow(ventana);
							return;
						}
						personaServicio.actualizar(persona, personaDocumentos);
						Notificacion.show(new Notificacion(
								"Se actualizo correctamente a la persona",
								Constantes.MENSAJE.TYPE_SUCCES));
					}
					resetearFormulario();
				} else {
					Notificacion.show(new Notificacion(
							"Debe llenar todos los campos",
							Constantes.MENSAJE.TYPE_ERROR));
				}
			} else {
				if (event.getSource() == this.btnCancelar) {
					resetearFormulario();
				} else {
					if (event.getSource() == this.btnBuscar) {
						Window ventana = SigeUtil.generarBuscador(new Window(),
								"BUSCAR PERSONA", "540px", "430px");
						ventana.setContent(new PersonaBuscar(ventana, this));
						UI.getCurrent().addWindow(ventana);
					} else {
						if (event.getSource() == this.btnEliminar) {
							if (!confirmacion) {
								Window ventana = SigeUtil.generarBuscador(
										new Window(), "INGRESAR MOTIVO", "360",
										"260");
								ventana.setContent(new PanelMotivoObservacion(
										ventana, this,
										Constantes.TIPO_OPERACION.ELIMINACION,
										(columnLenghts.get("motivomodifica"))));
								UI.getCurrent().addWindow(ventana);
								return;
							}
							ConfirmDialog.show(UI.getCurrent(), "Confirmación",
									"¿Desea elminar la persona?", "Aceptar",
									"Cancelar", new ConfirmDialog.Listener() {
										private static final long serialVersionUID = 1L;

										public void onClose(ConfirmDialog dialog) {
											if (dialog.isConfirmed()) {
												personaServicio
														.eliminarPersona(persona);
												resetearFormulario();
											}
										}
									});
						} else {
							if (event.getSource() == this.btnBuscarVia) {
								Window ventana = SigeUtil.generarBuscador(
										new Window(), "BUSCAR VIA", "460px",
										"355px");
								ventana.setContent(new ViaBuscar(ventana, this));
								UI.getCurrent().addWindow(ventana);
							} else if (event.getSource() == this.btnBuscarLugar) {
								Window ventana = SigeUtil.generarBuscador(
										new Window(), "BUSCAR LUGAR", "560px",
										"410px");
								ventana.setContent(new LugarBuscar(ventana,
										this));
								UI.getCurrent().addWindow(ventana);
							} else if (event.getSource() == this.btnAgregarLugar) {
								Window ventana = SigeUtil.generarBuscador(
										new Window(), "AGREGAR LUGAR", "650px",
										"210px");
								ventana.setContent(new LugarMantenimiento(
										ventana, this, permiso));
								UI.getCurrent().addWindow(ventana);
							} else if (event.getSource() == this.btnAgregarVia) {
								Window ventana = SigeUtil.generarBuscador(
										new Window(), "AGREGAR VIA", "680px",
										"350px");
								ventana.setContent(new ViaMantenimiento(
										ventana, this, permiso));
								UI.getCurrent().addWindow(ventana);
							} else if (event.getSource() == this.btnAgregr) {
								if (txtNumero.getValue().length() > 0
										&& cbxTipoDocumento.getValue() != null) {
									if (id == null) {
										if (codigoTipoDocumentoSeleccionado != null
												&& codigoTipoDocumentoSeleccionado
														.equals((Long) cbxTipoDocumento
																.getValue())) {
											eliminarDocumentoPersona(codigoTipoDocumentoSeleccionado);
											PersonaDocumento pd = new PersonaDocumento();
											pd.setNumeroDocumento(txtNumero
													.getValue());
											pd.setEstado(Boolean.TRUE);
											pd.setTipoDocumentoPersona(getTipoDocumentoPersona((Long) cbxTipoDocumento
													.getValue()));
											personaDocumentos.add(pd);
										} else {
											if (!validarTipoDocumento((Long) cbxTipoDocumento
													.getValue())) {
												eliminarDocumentoPersona(codigoTipoDocumentoSeleccionado);
												PersonaDocumento pd = new PersonaDocumento();
												pd.setEstado(Boolean.TRUE);
												pd.setNumeroDocumento(txtNumero
														.getValue());
												pd.setTipoDocumentoPersona(getTipoDocumentoPersona((Long) cbxTipoDocumento
														.getValue()));
												personaDocumentos.add(pd);
											} else {
												Notificacion
														.show(new Notificacion(
																"La persona ya tiene este tipo de documento",
																Constantes.MENSAJE.TYPE_ERROR));
											}
										}
									} else {
										PersonaDocumento pd = getPersonaDocumento(id);
										pd.setNumeroDocumento(txtNumero
												.getValue());
										pd.setTipoDocumentoPersona(getTipoDocumentoPersona((Long) cbxTipoDocumento
												.getValue()));
									}
									actualizarTabla();
									codigoTipoDocumentoSeleccionado = null;
									id = null;
									documentoSeleccionado = Boolean.FALSE;
									txtNumero.setValue("");
								} else {
									Notificacion.show(new Notificacion(
											"Debe llenar todos los datos",
											Constantes.MENSAJE.TYPE_ERROR));
								}

							} else if (event.getSource() == this.btnQuitar) {
								if (documentoSeleccionado) {
									eliminarDocumentoPersona(codigoTipoDocumentoSeleccionado);
									txtNumero.setValue("");
									actualizarTabla();
								} else {
									Notificacion
											.show(new Notificacion(
													"Debe seleccionar un elemento de la tabla",
													Constantes.MENSAJE.TYPE_WARNING));
								}
							} else if (event.getSource() == this.btnImprimir) {
								Window ventana = SigeUtil.generarBuscador(
										new Window(), "IMPRIMIR", "800px",
										"550px");
								Map<String, Object> parametros = new HashMap<String, Object>();
								parametros.put("personaId", persona.getId());
								ventana.setContent(new PDFVizualizador(this,
										permiso, parametros, null,
										"PersonasImprimir", null));
								UI.getCurrent().addWindow(ventana);
							}

						}
					}
				}
			}
		}
	}

	private Boolean validarTipoDocumento(Long codigoTipoDocumento) {
		for (int i = 0; i < personaDocumentos.size(); i++) {
			if (personaDocumentos.get(i).getEstado()) {
				if (personaDocumentos.get(i).getTipoDocumentoPersona().getId()
						.equals(codigoTipoDocumento)) {
					return true;
				}
			}
		}
		return false;
	}

	private void eliminarDocumentoPersona(Long codigoTipoDocumento) {
		for (int i = 0; i < personaDocumentos.size(); i++) {
			if (personaDocumentos.get(i).getEstado()) {
				if (personaDocumentos.get(i).getTipoDocumentoPersona().getId()
						.equals(codigoTipoDocumento)) {
					if (personaDocumentos.get(i).getId() == null) {
						personaDocumentos.remove(i);
					} else {
						personaDocumentos.get(i).setEstado(Boolean.FALSE);
					}
				}
			}
		}

	}

	private PersonaDocumento getPersonaDocumento(Long id) {
		for (int i = 0; i < personaDocumentos.size(); i++) {
			if (personaDocumentos.get(i).getEstado()) {
				if (personaDocumentos.get(i).getId().equals(id)) {
					return personaDocumentos.get(i);
				}
			}
		}
		return null;

	}

	private void actualizarTabla() {
		IndexedContainer contenedorRequisitos = (IndexedContainer) tblDatosDocumento
				.getContainerDataSource();
		contenedorRequisitos.removeAllItems();
		for (int i = 0; i < personaDocumentos.size(); i++) {
			if (personaDocumentos.get(i).getEstado()) {
				Item item = contenedorRequisitos.addItem(i);
				item.getItemProperty("id").setValue(
						personaDocumentos.get(i).getId());
				item.getItemProperty("codigo").setValue(
						personaDocumentos.get(i).getTipoDocumentoPersona()
								.getId());
				item.getItemProperty("documento").setValue(
						personaDocumentos.get(i).getTipoDocumentoPersona()
								.getAbreviatura());
				item.getItemProperty("numero").setValue(
						personaDocumentos.get(i).getNumeroDocumento());
			}
		}
	}

	private TipoDocumentoPersona getTipoDocumentoPersona(Long id) {
		return tipoDocumentoPersonaServicio.obtener(id);
	}

	public void respuesta(Persona persona) {
		if (quienLlama instanceof ExpedienteMantenimiento) {
			ExpedienteMantenimiento panel = (ExpedienteMantenimiento) quienLlama;
			panel.obtenerPersona(persona.getId());
			UI.getCurrent().removeWindow(windowContiene);
		} else {
			return;
		}
	}

	@AutoGenerated
	private AbsoluteLayout buildMainLayout() {
		// common part: create layout
		mainLayout = new AbsoluteLayout();
		mainLayout.setImmediate(false);
		mainLayout.setWidth("100%");
		mainLayout.setHeight("100%");

		// top-level component properties
		setWidth("100.0%");
		setHeight("100.0%");

		// lblNombre
		lblNombre = new Label();
		lblNombre.setImmediate(false);
		lblNombre.setWidth("-1px");
		lblNombre.setHeight("-1px");
		lblNombre.setValue("Nombres");
		mainLayout.addComponent(lblNombre, "top:40.0px;left:21.0px;");

		// lblApePaterno
		lblApePaterno = new Label();
		lblApePaterno.setImmediate(false);
		lblApePaterno.setWidth("-1px");
		lblApePaterno.setHeight("-1px");
		lblApePaterno.setValue("Apellido Paterno");
		mainLayout.addComponent(lblApePaterno, "top:77.0px;left:21.0px;");

		// lblApeMaterno
		lblApeMaterno = new Label();
		lblApeMaterno.setImmediate(false);
		lblApeMaterno.setWidth("-1px");
		lblApeMaterno.setHeight("-1px");
		lblApeMaterno.setValue("Apellido Materno");
		mainLayout.addComponent(lblApeMaterno, "top:76.0px;left:303.0px;");

		// lblTipoPersona
		lblTipoPersona = new Label();
		lblTipoPersona.setImmediate(false);
		lblTipoPersona.setWidth("-1px");
		lblTipoPersona.setHeight("18px");
		lblTipoPersona.setValue("Tipo de Persona");
		mainLayout.addComponent(lblTipoPersona, "top:10.0px;left:20.0px;");

		// lblLugar
		lblLugar = new Label();
		lblLugar.setImmediate(false);
		lblLugar.setWidth("-1px");
		lblLugar.setHeight("-1px");
		lblLugar.setValue("Lugar");
		mainLayout.addComponent(lblLugar, "top:140.0px;left:20.0px;");

		// lblTipoPersonaJur
		lblTipoPersonaJur = new Label();
		lblTipoPersonaJur.setImmediate(false);
		lblTipoPersonaJur.setWidth("-1px");
		lblTipoPersonaJur.setHeight("-1px");
		lblTipoPersonaJur.setValue("Tipo de Persona Juridica");
		mainLayout.addComponent(lblTipoPersonaJur, "top:10.0px;left:313.0px;");

		// lblVia
		lblVia = new Label();
		lblVia.setImmediate(false);
		lblVia.setWidth("-1px");
		lblVia.setHeight("-1px");
		lblVia.setValue("Vía");
		mainLayout.addComponent(lblVia, "top:174.0px;left:20.0px;");

		// cbxTipoPersona
		cbxTipoPersona = new ComboBox();
		cbxTipoPersona.setImmediate(false);
		cbxTipoPersona.setWidth("-1px");
		cbxTipoPersona.setHeight("-1px");
		cbxTipoPersona.setTabIndex(1);
		mainLayout.addComponent(cbxTipoPersona, "top:10.0px;left:122.0px;");

		// cbxTipoPersonaJuridica
		cbxTipoPersonaJuridica = new ComboBox();
		cbxTipoPersonaJuridica.setImmediate(false);
		cbxTipoPersonaJuridica.setWidth("162px");
		cbxTipoPersonaJuridica.setHeight("-1px");
		cbxTipoPersonaJuridica.setTabIndex(2);
		mainLayout.addComponent(cbxTipoPersonaJuridica,
				"top:10.0px;left:453.0px;");

		// txtNombres
		txtNombres = new TextField();
		txtNombres.setImmediate(false);
		txtNombres.setWidth("278px");
		txtNombres.setHeight("-1px");
		mainLayout.addComponent(txtNombres, "top:40.0px;left:122.0px;");

		// txtApePaterno
		txtApePaterno = new TextField();
		txtApePaterno.setImmediate(false);
		txtApePaterno.setWidth("178px");
		txtApePaterno.setHeight("-1px");
		mainLayout.addComponent(txtApePaterno, "top:73.0px;left:122.0px;");

		// txtApeMaterno
		txtApeMaterno = new TextField();
		txtApeMaterno.setImmediate(false);
		txtApeMaterno.setWidth("200px");
		txtApeMaterno.setHeight("-1px");
		mainLayout.addComponent(txtApeMaterno, "top:73.0px;left:400.0px;");

		// lblNombreCompleto
		lblNombreCompleto = new Label();
		lblNombreCompleto.setImmediate(false);
		lblNombreCompleto.setWidth("-1px");
		lblNombreCompleto.setHeight("-1px");
		lblNombreCompleto.setValue("Nombre Completo");
		mainLayout.addComponent(lblNombreCompleto, "top:110.0px;left:20.0px;");

		// txtNombreCompleto
		txtNombreCompleto = new TextField();
		txtNombreCompleto.setImmediate(false);
		txtNombreCompleto.setWidth("476px");
		txtNombreCompleto.setHeight("-1px");
		mainLayout.addComponent(txtNombreCompleto, "top:108.0px;left:124.0px;");

		// txtLugar
		txtLugar = new TextField();
		txtLugar.setImmediate(false);
		txtLugar.setWidth("419px");
		txtLugar.setHeight("-1px");
		mainLayout.addComponent(txtLugar, "top:140.0px;left:121.0px;");

		// btnBuscarLugar
		btnBuscarLugar = new Boton();
		btnBuscarLugar.setIcon(new ThemeResource("images/botones/find.png"));
		btnBuscarLugar.setImmediate(true);
		btnBuscarLugar.setWidth("28px");
		btnBuscarLugar.setHeight("24px");
		mainLayout.addComponent(btnBuscarLugar, "top:140.0px;left:540.0px;");

		// txtVia
		txtVia = new TextField();
		txtVia.setImmediate(false);
		txtVia.setWidth("419px");
		txtVia.setHeight("24px");
		mainLayout.addComponent(txtVia, "top:171.0px;left:121.0px;");

		// btnBuscarVia
		btnBuscarVia = new Boton();
		btnBuscarVia.setIcon(new ThemeResource("images/botones/find.png"));
		btnBuscarVia.setImmediate(true);
		btnBuscarVia.setWidth("28px");
		btnBuscarVia.setHeight("24px");
		mainLayout.addComponent(btnBuscarVia, "top:171.0px;left:540.0px;");

		// pnlDireccion
		pnlDireccion = buildPnlDireccion();
		mainLayout.addComponent(pnlDireccion, "top:206.0px;left:20.0px;");

		// btnNuevo
		btnNuevo = new Button();
		btnNuevo.setCaption("Nuevo");
		btnNuevo.setIcon(new ThemeResource("images/botones/new.png"));
		btnNuevo.setImmediate(true);
		btnNuevo.setWidth("100px");
		btnNuevo.setHeight("-1px");
		mainLayout.addComponent(btnNuevo, "top:414.0px;left:21.0px;");

		// btnGuardar
		btnGuardar = new Button();
		btnGuardar.setCaption("Guardar");
		btnGuardar.setIcon(new ThemeResource("images/botones/save.png"));
		btnGuardar.setImmediate(true);
		btnGuardar.setWidth("100px");
		btnGuardar.setHeight("-1px");
		mainLayout.addComponent(btnGuardar, "top:414.0px;left:124.0px;");

		// btnEliminar
		btnEliminar = new Button();
		btnEliminar.setCaption("Eliminar");
		btnEliminar.setIcon(new ThemeResource("images/botones/delete.png"));
		btnEliminar.setImmediate(true);
		btnEliminar.setWidth("100px");
		btnEliminar.setHeight("-1px");
		mainLayout.addComponent(btnEliminar, "top:414.0px;left:227.0px;");

		// btnCancelar
		btnCancelar = new Button();
		btnCancelar.setCaption("Cancelar");
		btnCancelar.setIcon(new ThemeResource("images/botones/undo.png"));
		btnCancelar.setImmediate(true);
		btnCancelar.setWidth("95px");
		btnCancelar.setHeight("-1px");
		mainLayout.addComponent(btnCancelar, "top:414.0px;left:329.0px;");

		// btnBuscar
		btnBuscar = new Button();
		btnBuscar.setCaption("Buscar");
		btnBuscar.setIcon(new ThemeResource("images/botones/find.png"));
		btnBuscar.setImmediate(true);
		btnBuscar.setWidth("90px");
		btnBuscar.setHeight("-1px");
		mainLayout.addComponent(btnBuscar, "top:414.0px;left:428.0px;");

		// btnImprimir
		btnImprimir = new Button();
		btnImprimir.setCaption("Imprimir");
		btnImprimir.setIcon(new ThemeResource("images/botones/print.png"));
		btnImprimir.setImmediate(true);
		btnImprimir.setWidth("-1px");
		btnImprimir.setHeight("-1px");
		mainLayout.addComponent(btnImprimir, "top:414.0px;left:521.0px;");

		// btnAgregarLugar
		btnAgregarLugar = new Boton();
		btnAgregarLugar.setIcon(new ThemeResource("images/botones/add.png"));
		btnAgregarLugar.setImmediate(false);
		btnAgregarLugar.setWidth("28px");
		btnAgregarLugar.setHeight("24px");
		mainLayout.addComponent(btnAgregarLugar, "top:140.0px;left:572.0px;");

		// btnAgregarVia
		btnAgregarVia = new Boton();
		btnAgregarVia.setIcon(new ThemeResource("images/botones/add.png"));
		btnAgregarVia.setImmediate(false);
		btnAgregarVia.setWidth("28px");
		btnAgregarVia.setHeight("24px");
		mainLayout.addComponent(btnAgregarVia, "top:171.0px;left:572.0px;");

		// panel_1
		panel_1 = buildPanel_1();
		mainLayout.addComponent(panel_1, "top:287.0px;left:21.0px;");

		return mainLayout;
	}

	@AutoGenerated
	private Panel buildPnlDireccion() {
		// common part: create layout
		pnlDireccion = new Panel();
		pnlDireccion.setCaption("Direección");
		pnlDireccion.setImmediate(false);
		pnlDireccion.setWidth("580px");
		pnlDireccion.setHeight("68px");

		// DireccionLayout
		DireccionLayout = buildDireccionLayout();
		pnlDireccion.setContent(DireccionLayout);

		return pnlDireccion;
	}

	@AutoGenerated
	private AbsoluteLayout buildDireccionLayout() {
		// common part: create layout
		DireccionLayout = new AbsoluteLayout();
		DireccionLayout.setImmediate(false);
		DireccionLayout.setWidth("100.0%");
		DireccionLayout.setHeight("100.0%");

		// lblNumeroDir
		lblNumeroDir = new Label();
		lblNumeroDir.setImmediate(false);
		lblNumeroDir.setWidth("-1px");
		lblNumeroDir.setHeight("-1px");
		lblNumeroDir.setValue("Número");
		DireccionLayout.addComponent(lblNumeroDir, "top:15.0px;left:4.0px;");

		// txtNumeroDir
		txtNumeroDir = new TextField();
		txtNumeroDir.setImmediate(false);
		txtNumeroDir.setWidth("67px");
		txtNumeroDir.setHeight("-1px");
		DireccionLayout.addComponent(txtNumeroDir, "top:13.0px;left:54.0px;");

		// lblDepartamentoDir
		lblDepartamentoDir = new Label();
		lblDepartamentoDir.setImmediate(false);
		lblDepartamentoDir.setWidth("-1px");
		lblDepartamentoDir.setHeight("-1px");
		lblDepartamentoDir.setValue("Departamento");
		DireccionLayout.addComponent(lblDepartamentoDir,
				"top:15.0px;left:128.0px;");

		// txtDepartamentoDir
		txtDepartamentoDir = new TextField();
		txtDepartamentoDir.setImmediate(false);
		txtDepartamentoDir.setWidth("71px");
		txtDepartamentoDir.setHeight("-1px");
		DireccionLayout.addComponent(txtDepartamentoDir,
				"top:13.0px;left:211.0px;");

		// lblPisoDir
		lblPisoDir = new Label();
		lblPisoDir.setImmediate(false);
		lblPisoDir.setWidth("-1px");
		lblPisoDir.setHeight("-1px");
		lblPisoDir.setValue("Piso");
		DireccionLayout.addComponent(lblPisoDir, "top:15.0px;left:285.0px;");

		// lblManzanaDir
		lblManzanaDir = new Label();
		lblManzanaDir.setImmediate(false);
		lblManzanaDir.setWidth("-1px");
		lblManzanaDir.setHeight("-1px");
		lblManzanaDir.setValue("Manzana");
		DireccionLayout.addComponent(lblManzanaDir, "top:15.0px;left:370.0px;");

		// lblLoteDir
		lblLoteDir = new Label();
		lblLoteDir.setImmediate(false);
		lblLoteDir.setWidth("-1px");
		lblLoteDir.setHeight("-1px");
		lblLoteDir.setValue("Lote");
		DireccionLayout.addComponent(lblLoteDir, "top:15.0px;left:480.0px;");

		// txtLoteDir
		txtLoteDir = new TextField();
		txtLoteDir.setImmediate(false);
		txtLoteDir.setWidth("49px");
		txtLoteDir.setHeight("-1px");
		DireccionLayout.addComponent(txtLoteDir, "top:13.0px;left:513.0px;");

		// txtManzanaDir
		txtManzanaDir = new TextField();
		txtManzanaDir.setImmediate(false);
		txtManzanaDir.setWidth("47px");
		txtManzanaDir.setHeight("-1px");
		DireccionLayout.addComponent(txtManzanaDir, "top:13.0px;left:425.0px;");

		// txtPisoDir
		txtPisoDir = new TextField();
		txtPisoDir.setImmediate(false);
		txtPisoDir.setWidth("49px");
		txtPisoDir.setHeight("-1px");
		DireccionLayout.addComponent(txtPisoDir, "top:13.0px;left:315.0px;");

		return DireccionLayout;
	}

	@AutoGenerated
	private Panel buildPanel_1() {
		// common part: create layout
		panel_1 = new Panel();
		panel_1.setCaption("Datos de Documento");
		panel_1.setImmediate(false);
		panel_1.setWidth("594px");
		panel_1.setHeight("122px");

		// absoluteLayout_2
		absoluteLayout_2 = buildAbsoluteLayout_2();
		panel_1.setContent(absoluteLayout_2);

		return panel_1;
	}

	@AutoGenerated
	private AbsoluteLayout buildAbsoluteLayout_2() {
		// common part: create layout
		absoluteLayout_2 = new AbsoluteLayout();
		absoluteLayout_2.setImmediate(false);
		absoluteLayout_2.setWidth("100.0%");
		absoluteLayout_2.setHeight("100.0%");

		// lblTipoDocumento
		lblTipoDocumento = new Label();
		lblTipoDocumento.setImmediate(false);
		lblTipoDocumento.setWidth("-1px");
		lblTipoDocumento.setHeight("-1px");
		lblTipoDocumento.setValue("Tipo Documento:");
		absoluteLayout_2
				.addComponent(lblTipoDocumento, "top:6.0px;left:4.0px;");

		// cbxTipoDocumento
		cbxTipoDocumento = new ComboBox();
		cbxTipoDocumento.setImmediate(false);
		cbxTipoDocumento.setWidth("214px");
		cbxTipoDocumento.setHeight("-1px");
		cbxTipoDocumento.setTabIndex(15);
		absoluteLayout_2.addComponent(cbxTipoDocumento,
				"top:25.0px;left:4.0px;");

		// tblDatosDocumento
		tblDatosDocumento = new Table();
		tblDatosDocumento.setImmediate(false);
		tblDatosDocumento.setWidth("350px");
		tblDatosDocumento.setHeight("88px");
		absoluteLayout_2.addComponent(tblDatosDocumento,
				"top:7.0px;left:238.0px;");

		// lblNumero
		lblNumero = new Label();
		lblNumero.setImmediate(false);
		lblNumero.setWidth("-1px");
		lblNumero.setHeight("-1px");
		lblNumero.setValue("Numero:");
		absoluteLayout_2.addComponent(lblNumero, "top:50.0px;left:4.0px;");

		// btnAgregr
		btnAgregr = new Boton();
		btnAgregr.setIcon(new ThemeResource("images/botones/add.png"));
		btnAgregr.setImmediate(false);
		btnAgregr.setDescription("Agregar Requisito");
		btnAgregr.setWidth("35px");
		btnAgregr.setHeight("-1px");
		absoluteLayout_2.addComponent(btnAgregr, "top:68.0px;left:163.0px;");

		// btnQuitar
		btnQuitar = new Boton();
		btnQuitar.setIcon(new ThemeResource("images/botones/remove.png"));
		btnQuitar.setImmediate(false);
		btnQuitar.setDescription("Quitar Requisito");
		btnQuitar.setWidth("35px");
		btnQuitar.setHeight("-1px");
		absoluteLayout_2.addComponent(btnQuitar, "top:68.0px;left:200.0px;");

		// txtNumero
		txtNumero = new TextField();
		txtNumero.setImmediate(false);
		txtNumero.setWidth("152px");
		txtNumero.setHeight("-1px");
		absoluteLayout_2.addComponent(txtNumero, "top:68.0px;left:4.0px;");

		return absoluteLayout_2;
	}

}